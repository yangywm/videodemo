<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤šç›´æ’­é—´æ’­æ”¾å™¨</title>
    
    <!-- Video.js CSS -->
    <link href="https://vjs.zencdn.net/8.23.3/video-js.css" rel="stylesheet" />
    
    <!-- è‡ªå®šä¹‰æ ·å¼ -->
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        .header h1 {
            color: #333;
            margin-bottom: 10px;
        }
        .header p {
            color: #666;
            font-size: 16px;
        }
        .stream-container {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }
        .stream-item {
            background: white;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s ease;
        }
        .stream-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }
        .stream-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
            text-align: center;
        }
        .video-js {
            width: 100%;
            height: 300px;
        }
        .stream-info {
            margin-top: 10px;
            padding: 10px;
            background-color: #f8f9fa;
            border-radius: 5px;
            font-size: 14px;
            color: #666;
        }
        .stream-url {
            display: block;
            max-width: 100%;
            white-space: nowrap;
            overflow-x: auto;
            text-overflow: ellipsis;
            cursor: pointer;
        }
        .controls {
            text-align: center;
            margin: 20px 0;
        }
        .control-btn {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 0 5px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.2s;
        }
        .control-btn:hover {
            background-color: #0056b3;
        }
        .control-btn:disabled {
            background-color: #6c757d;
            cursor: not-allowed;
        }
        @media (max-width: 768px) {
            .stream-container {
                grid-template-columns: 1fr;
            }
            body {
                padding: 10px;
            }
            .video-js {
                height: 250px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ”´ å¤šç›´æ’­é—´æ’­æ”¾å™¨</h1>
        <p>æ”¯æŒåŒæ—¶æ’­æ”¾å¤šä¸ªç›´æ’­æµ</p>
    </div>
    <div class="controls">
        <button class="control-btn" onclick="playAllStreams()">æ’­æ”¾å…¨éƒ¨</button>
        <button class="control-btn" onclick="pauseAllStreams()">æš‚åœå…¨éƒ¨</button>
        <button class="control-btn" onclick="muteAllStreams()">é™éŸ³å…¨éƒ¨</button>
        <button class="control-btn" onclick="unmuteAllStreams()">å–æ¶ˆé™éŸ³</button>
    </div>
    
    <!-- ç›´æ’­æµåœ°å€è¾“å…¥åŒºåŸŸ -->
    <div class="stream-input-section" style="max-width: 1400px; margin: 20px auto; padding: 20px; background: white; border-radius: 10px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);">
        <h3 style="color: #333; margin-bottom: 15px;">ğŸ¯ æ·»åŠ ç›´æ’­æµ</h3>
        <div style="display: flex; gap: 10px; flex-wrap: wrap; align-items: center;">
            <input type="text" id="streamUrlInput" placeholder="è¾“å…¥ç›´æ’­æµåœ°å€ (æ”¯æŒHLS .m3u8, HTTP-FLV .flv, RTMP rtmp://)" 
                   style="flex: 1; min-width: 300px; padding: 10px; border: 2px solid #ddd; border-radius: 5px; font-size: 14px;">
            <select id="streamTypeSelect" style="padding: 10px; border: 2px solid #ddd; border-radius: 5px; font-size: 14px;">
                <option value="auto">è‡ªåŠ¨æ£€æµ‹</option>
                <option value="hls">HLS (.m3u8)</option>
                <option value="flv">HTTP-FLV (.flv)</option>
                <option value="rtmp">RTMP (rtmp://)</option>
            </select>
            <input type="text" id="streamTitleInput" placeholder="ç›´æ’­é—´åç§°" 
                   style="min-width: 150px; padding: 10px; border: 2px solid #ddd; border-radius: 5px; font-size: 14px;">
            <button onclick="addCustomStream()" class="control-btn">æ·»åŠ æµ</button>
            <button onclick="resetStreams()" class="control-btn" style="background-color: #dc3545;">é‡ç½®</button>
        </div>
        <div style="margin-top: 10px; font-size: 12px; color: #666;">
            <strong>ç¤ºä¾‹åœ°å€ï¼š</strong><br>
            â€¢ HLS: https://example.com/live/stream.m3u8<br>
            â€¢ HTTP-FLV: https://example.com/live/stream.flv<br>
            â€¢ RTMP: rtmp://example.com/live/stream
        </div>
    </div>
    <div class="stream-container" id="streamContainer">
        <!-- åŠ¨æ€æ’å…¥ç›´æ’­æµå¡ç‰‡ -->
    </div>
    <!-- Video.js JavaScript -->
    <script src="https://vjs.zencdn.net/8.23.3/video.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@videojs/http-streaming@3.10.0/dist/videojs-http-streaming.min.js"></script>
    
    <!-- FLV.js for HTTP-FLV support (ç›´æ’­æ ¼å¼æ”¯æŒ) -->
    <script src="https://cdn.jsdelivr.net/npm/flv.js@1.6.2/dist/flv.min.js"></script>
    
    <!-- Video.js FLV plugin -->
    <script src="https://cdn.jsdelivr.net/npm/videojs-flvjs@1.1.0/dist/videojs-flvjs.min.js"></script>
    <script>
        // ====== é…ç½®åŒº ======
        // æ¯è¡Œç›´æ’­æµæ•°é‡
        const colCount = 4;
        // è¡Œæ•°å˜é‡ï¼ˆå¯éšæ„æ›´æ”¹ï¼‰
        const rowCount = 2; // ä½ å¯ä»¥æ”¹æˆ3ã€4ç­‰
        // ç›´æ’­æµæ•°æ®ï¼ˆæ”¯æŒå¤šç§æ ¼å¼ï¼šHLSã€HTTP-FLVã€RTMPç­‰ï¼‰
        const streamList = [
            {
                title: 'ç›´æ’­é—´ 1',
                src: 'https://demo.unified-streaming.com/k8s/features/stable/video/tears-of-steel/tears-of-steel.ism/.m3u8',
                type: 'hls'
            },
            {
                title: 'ç›´æ’­é—´ 2',
                src: 'https://cph-p2p-msl.akamaized.net/hls/live/2000341/test.flv',
                type: 'flv'
            },
            {
                title: 'ç›´æ’­é—´ 3',
                src: 'https://bitdash-a.akamaihd.net/content/sintel/hls/playlist.m3u8',
                type: 'hls'
            },
            {
                title: 'ç›´æ’­é—´ 4',
                src: 'rtmp://live.hkstv.hk.lxdns.com/live/hks2',
                type: 'rtmp'
            },
            {
                title: 'ç›´æ’­é—´ 5',
                src: 'https://demo.unified-streaming.com/k8s/features/stable/video/tears-of-steel/tears-of-steel.ism/.m3u8',
                type: 'hls'
            },
            {
                title: 'ç›´æ’­é—´ 6',
                src: 'https://cph-p2p-msl.akamaized.net/hls/live/2000341/test.flv',
                type: 'flv'
            },
            {
                title: 'ç›´æ’­é—´ 7',
                src: 'https://bitdash-a.akamaihd.net/content/sintel/hls/playlist.m3u8',
                type: 'hls'
            },
            {
                title: 'ç›´æ’­é—´ 8',
                src: 'rtmp://live.hkstv.hk.lxdns.com/live/hks1',
                type: 'rtmp'
            },
            // å¦‚éœ€æ›´å¤šæµï¼Œç»§ç»­æ·»åŠ 
        ];
        // è‡ªåŠ¨è¡¥è¶³streamListåˆ°rowCount*colCountä¸ª
        while (streamList.length < rowCount * colCount) {
            streamList.push({
                title: `ç›´æ’­é—´ ${streamList.length + 1}`,
                src: '', // å¯ç•™ç©ºæˆ–å¡«é»˜è®¤æµ
            });
        }
        // ====== åŠ¨æ€æ¸²æŸ“ç›´æ’­æµå¡ç‰‡ ======
        function renderStreams() {
            const container = document.getElementById('streamContainer');
            container.innerHTML = '';
            for (let i = 0; i < rowCount * colCount; i++) {
                const stream = streamList[i];
                const streamId = `stream${i + 1}`; // ä¿®å¤IDä¸åŒ¹é…é—®é¢˜
                const statusId = `status${i + 1}`;
                // åªæ˜¾ç¤ºå‰6ä½+...+å28ä½
                let shortSrc = stream.src;
                if (shortSrc && shortSrc.length > 40) {
                    shortSrc = shortSrc.slice(0, 6) + '...' + shortSrc.slice(-34);
                }
                container.innerHTML += `
                <div class="stream-item">
                    <div class="stream-title">${stream.title} - ${streamId}</div>
                    <video-js
                        id="${streamId}"
                        class="video-js vjs-default-skin"
                        controls
                        preload="auto"
                        data-setup='{}'>
                        ${stream.src ? `<source src="${stream.src}" type="application/x-mpegURL">` : ''}
                        <p class="vjs-no-js">
                            To view this video please enable JavaScript, and consider upgrading to a web browser that
                            <a href="https://videojs.com/html5-video-support/" target="_blank">supports HTML5 video</a>.
                        </p>
                    </video-js>
                    <div class="stream-info">
                        <strong>çŠ¶æ€:</strong> <span id="${statusId}">å‡†å¤‡å°±ç»ª</span><br>
                        <strong>æµåœ°å€ï¼š</strong> <span class="stream-url" title="${stream.src}">${shortSrc}</span><br>
                        <strong>æµæ ¼å¼ï¼š</strong> <span style="color: #007bff; font-weight: bold;">${stream.type ? stream.type.toUpperCase() : 'HLS'}</span><br>
                    </div>
                </div>
                `;
            }
        }
        // ====== Video.jsåŠŸèƒ½åŒº ======
        let players = {};
        function initializePlayers() {
            for (let i = 0; i < rowCount * colCount; i++) {
                const streamId = `stream${i + 1}`;
                const stream = streamList[i];
                
                // æ ¹æ®æµç±»å‹è®¾ç½®è§†é¢‘æº
                let sources = [];
                if (stream.src) {
                    switch(stream.type) {
                        case 'hls':
                            sources = [{
                                src: stream.src,
                                type: 'application/x-mpegURL'
                            }];
                            break;
                        case 'flv':
                            sources = [{
                                src: stream.src,
                                type: 'video/x-flv'
                            }];
                            break;
                        case 'rtmp':
                            sources = [{
                                src: stream.src,
                                type: 'rtmp/mp4'
                            }];
                            break;
                        default:
                            sources = [{
                                src: stream.src,
                                type: 'application/x-mpegURL'
                            }];
                    }
                }
                
                // æ ¹æ®æµç±»å‹é…ç½®æ’­æ”¾å™¨
                let playerConfig = {
                    fluid: true,
                    responsive: true,
                    playbackRates: [0.5, 1, 1.25, 1.5, 2],
                    controls: true,
                    preload: 'metadata',
                    sources: sources
                };
                
                // é’ˆå¯¹ä¸åŒæ ¼å¼çš„ç‰¹æ®Šé…ç½®
                if (stream.type === 'flv') {
                    playerConfig.techOrder = ['flvjs', 'html5'];
                    playerConfig.flvjs = {
                        mediaDataSource: {
                            isLive: true,
                            cors: true,
                            withCredentials: false
                        }
                    };
                } else if (stream.type === 'hls') {
                    playerConfig.html5 = {
                        hls: {
                            enableLowInitialPlaylist: true,
                            smoothQualityChange: true,
                            overrideNative: true
                        }
                    };
                    playerConfig.techOrder = ['html5'];
                } else if (stream.type === 'rtmp') {
                    playerConfig.techOrder = ['flash', 'html5'];
                    playerConfig.flash = {
                        swf: 'https://vjs.zencdn.net/swf/5.4.2/video-js.swf'
                    };
                }
                
                players[streamId] = videojs(streamId, playerConfig);
                players[streamId].on('loadstart', function() {
                    updateStatus(streamId, 'åŠ è½½ä¸­...');
                });
                players[streamId].on('canplay', function() {
                    updateStatus(streamId, 'å‡†å¤‡æ’­æ”¾');
                });
                players[streamId].on('playing', function() {
                    updateStatus(streamId, 'æ­£åœ¨æ’­æ”¾');
                });
                players[streamId].on('pause', function() {
                    updateStatus(streamId, 'å·²æš‚åœ');
                });
                players[streamId].on('ended', function() {
                    updateStatus(streamId, 'æ’­æ”¾ç»“æŸ');
                });
                players[streamId].on('error', function(e) {
                    console.error(`æ’­æ”¾å™¨ ${streamId} é”™è¯¯:`, e);
                    const error = players[streamId].error();
                    let errorMsg = 'æ’­æ”¾é”™è¯¯';
                    if (error) {
                        switch(error.code) {
                            case 1:
                                errorMsg = 'æ’­æ”¾é”™è¯¯: ç”¨æˆ·ä¸­æ­¢';
                                break;
                            case 2:
                                errorMsg = 'æ’­æ”¾é”™è¯¯: ç½‘ç»œé”™è¯¯';
                                break;
                            case 3:
                                errorMsg = 'æ’­æ”¾é”™è¯¯: è§£ç é”™è¯¯';
                                break;
                            case 4:
                                errorMsg = 'æ’­æ”¾é”™è¯¯: ä¸æ”¯æŒçš„æ ¼å¼';
                                break;
                            default:
                                errorMsg = `æ’­æ”¾é”™è¯¯: ${error.message || 'æœªçŸ¥é”™è¯¯'}`;
                        }
                    }
                    updateStatus(streamId, errorMsg);
                });
                players[streamId].on('waiting', function() {
                    updateStatus(streamId, 'ç¼“å†²ä¸­...');
                });
            }
        }
        function updateStatus(streamId, status) {
            const statusElement = document.getElementById('status' + streamId.replace('stream', ''));
            if (statusElement) {
                statusElement.textContent = status;
                statusElement.style.color = getStatusColor(status);
            }
        }
        function getStatusColor(status) {
            switch(status) {
                case 'æ­£åœ¨æ’­æ”¾': return '#28a745';
                case 'å·²æš‚åœ': return '#ffc107';
                case 'æ’­æ”¾é”™è¯¯': return '#dc3545';
                case 'ç¼“å†²ä¸­...': return '#17a2b8';
                case 'åŠ è½½ä¸­...': return '#17a2b8';
                default: return '#6c757d';
            }
        }
        function playAllStreams() {
            Object.values(players).forEach(player => {
                if (player && typeof player.play === 'function') {
                    player.play().catch(e => {
                        console.log('æ’­æ”¾å¤±è´¥:', e);
                    });
                }
            });
        }
        function pauseAllStreams() {
            Object.values(players).forEach(player => {
                if (player && typeof player.pause === 'function') {
                    player.pause();
                }
            });
        }
        function muteAllStreams() {
            Object.values(players).forEach(player => {
                if (player && typeof player.muted === 'function') {
                    player.muted(true);
                }
            });
        }
        function unmuteAllStreams() {
            Object.values(players).forEach(player => {
                if (player && typeof player.muted === 'function') {
                    player.muted(false);
                }
            });
        }
        
        // æ·»åŠ è‡ªå®šä¹‰ç›´æ’­æµ
        function addCustomStream() {
            const urlInput = document.getElementById('streamUrlInput');
            const typeSelect = document.getElementById('streamTypeSelect');
            const titleInput = document.getElementById('streamTitleInput');
            
            const url = urlInput.value.trim();
            const selectedType = typeSelect.value;
            const title = titleInput.value.trim() || 'è‡ªå®šä¹‰ç›´æ’­é—´';
            
            if (!url) {
                alert('è¯·è¾“å…¥ç›´æ’­æµåœ°å€');
                return;
            }
            
            // è‡ªåŠ¨æ£€æµ‹æµæ ¼å¼
            let streamType = selectedType === 'auto' ? detectStreamFormat(url) : selectedType;
            
            // æ‰¾åˆ°ç¬¬ä¸€ä¸ªç©ºçš„æµä½ç½®æˆ–æ·»åŠ åˆ°æœ«å°¾
            let targetIndex = -1;
            for (let i = 0; i < streamList.length; i++) {
                if (!streamList[i].src) {
                    targetIndex = i;
                    break;
                }
            }
            
            if (targetIndex === -1) {
                // å¦‚æœæ²¡æœ‰ç©ºä½ç½®ï¼Œæ›¿æ¢ç¬¬ä¸€ä¸ª
                targetIndex = 0;
            }
            
            // æ›´æ–°æµåˆ—è¡¨
            streamList[targetIndex] = {
                title: `${title} (${streamType.toUpperCase()})`,
                src: url,
                type: streamType
            };
            
            // é‡æ–°æ¸²æŸ“å’Œåˆå§‹åŒ–
            renderStreams();
            setTimeout(() => {
                initializePlayers();
                loadValidStreams();
            }, 100);
            
            // æ¸…ç©ºè¾“å…¥æ¡†
            urlInput.value = '';
            titleInput.value = '';
            typeSelect.value = 'auto';
            
            console.log(`æ·»åŠ äº†æ–°çš„${streamType.toUpperCase()}æµ:`, url);
        }
        
        // é‡ç½®ä¸ºé»˜è®¤æµ
        function resetStreams() {
            if (confirm('ç¡®å®šè¦é‡ç½®ä¸ºé»˜è®¤çš„æ¼”ç¤ºæµå—ï¼Ÿ')) {
                // é”€æ¯ç°æœ‰æ’­æ”¾å™¨
                Object.values(players).forEach(player => {
                    if (player && typeof player.dispose === 'function') {
                        player.dispose();
                    }
                });
                players = {};
                
                // é‡ç½®ä¸ºé»˜è®¤æµåˆ—è¡¨
                streamList.length = 0;
                streamList.push(
                    {
                        title: 'ç›´æ’­é—´ 1',
                        src: 'https://demo.unified-streaming.com/k8s/features/stable/video/tears-of-steel/tears-of-steel.ism/.m3u8',
                        type: 'hls'
                    },
                    {
                        title: 'ç›´æ’­é—´ 2',
                        src: 'https://cph-p2p-msl.akamaized.net/hls/live/2000341/test.flv',
                        type: 'flv'
                    },
                    {
                        title: 'ç›´æ’­é—´ 3',
                        src: 'https://bitdash-a.akamaihd.net/content/sintel/hls/playlist.m3u8',
                        type: 'hls'
                    },
                    {
                        title: 'ç›´æ’­é—´ 4',
                        src: 'rtmp://live.hkstv.hk.lxdns.com/live/hks2',
                        type: 'rtmp'
                    },
                    {
                        title: 'ç›´æ’­é—´ 5',
                        src: 'https://demo.unified-streaming.com/k8s/features/stable/video/tears-of-steel/tears-of-steel.ism/.m3u8',
                        type: 'hls'
                    },
                    {
                        title: 'ç›´æ’­é—´ 6',
                        src: 'https://cph-p2p-msl.akamaized.net/hls/live/2000341/test.flv',
                        type: 'flv'
                    },
                    {
                        title: 'ç›´æ’­é—´ 7',
                        src: 'https://bitdash-a.akamaihd.net/content/sintel/hls/playlist.m3u8',
                        type: 'hls'
                    },
                    {
                        title: 'ç›´æ’­é—´ 8',
                        src: 'rtmp://live.hkstv.hk.lxdns.com/live/hks1',
                        type: 'rtmp'
                    }
                );
                
                // é‡æ–°æ¸²æŸ“
                renderStreams();
                setTimeout(() => {
                    initializePlayers();
                    loadValidStreams();
                }, 100);
            }
        }
        document.addEventListener('DOMContentLoaded', function() {
            renderStreams();
            // å»¶è¿Ÿåˆå§‹åŒ–æ’­æ”¾å™¨ï¼Œç¡®ä¿DOMå®Œå…¨æ¸²æŸ“
            setTimeout(() => {
                initializePlayers();
                // è‡ªåŠ¨å°è¯•åŠ è½½æœ‰æ•ˆçš„æµ
                loadValidStreams();
            }, 100);
        });
        
        // æ£€æµ‹ç›´æ’­æµæ ¼å¼
        function detectStreamFormat(url) {
            if (!url) return 'unknown';
            
            // ç›´æ’­æµæ ¼å¼æ£€æµ‹
            if (url.includes('.flv') || url.includes('flv')) {
                return 'flv';
            } else if (url.includes('.m3u8') || url.includes('hls')) {
                return 'hls';
            } else if (url.startsWith('rtmp://') || url.includes('rtmp')) {
                return 'rtmp';
            } else if (url.includes('webrtc') || url.includes('rtc')) {
                return 'webrtc';
            }
            
            return 'hls'; // é»˜è®¤ä½¿ç”¨HLS
        }
        
        // åŠ è½½æœ‰æ•ˆçš„æµ
        function loadValidStreams() {
            Object.keys(players).forEach(streamId => {
                const player = players[streamId];
                const streamIndex = parseInt(streamId.replace('stream', '')) - 1;
                const stream = streamList[streamIndex];
                
                if (stream && stream.src && player) {
                    updateStatus(streamId, `æ£€æŸ¥${stream.type ? stream.type.toUpperCase() : ''}æµåœ°å€...`);
                    
                    // æ ¹æ®æµç±»å‹è¿›è¡Œç‰¹æ®Šå¤„ç†
                    player.ready(() => {
                        try {
                            if (stream.type === 'flv') {
                                // HTTP-FLV æµå¤„ç†
                                if (flvjs && flvjs.isSupported()) {
                                    player.src({
                                        src: stream.src,
                                        type: 'video/x-flv'
                                    });
                                } else {
                                    updateStatus(streamId, 'FLVæ ¼å¼ä¸æ”¯æŒ');
                                    return;
                                }
                            } else if (stream.type === 'rtmp') {
                                // RTMP æµå¤„ç†
                                player.src({
                                    src: stream.src,
                                    type: 'rtmp/mp4'
                                });
                            } else {
                                // HLS æµå¤„ç†
                                player.src({
                                    src: stream.src,
                                    type: 'application/x-mpegURL'
                                });
                            }
                            
                            // æ·»åŠ æµæ ¼å¼ç‰¹å®šçš„äº‹ä»¶ç›‘å¬
                            addStreamFormatListeners(player, streamId, stream.type);
                            
                        } catch (error) {
                            console.error(`åŠ è½½æµ ${streamId} å¤±è´¥:`, error);
                            updateStatus(streamId, `åŠ è½½å¤±è´¥: ${error.message}`);
                        }
                    });
                } else if (!stream.src) {
                    updateStatus(streamId, 'æ— æµåœ°å€');
                }
            });
        }
        
        // æ·»åŠ æµæ ¼å¼ç‰¹å®šçš„äº‹ä»¶ç›‘å¬å™¨
        function addStreamFormatListeners(player, streamId, streamType) {
            if (streamType === 'flv') {
                // FLV ç‰¹å®šäº‹ä»¶
                player.on('flvjs-media-info', function(event, info) {
                    console.log(`FLVåª’ä½“ä¿¡æ¯ ${streamId}:`, info);
                });
                
                player.on('flvjs-statistics-info', function(event, info) {
                    console.log(`FLVç»Ÿè®¡ä¿¡æ¯ ${streamId}:`, info);
                });
            } else if (streamType === 'rtmp') {
                // RTMP ç‰¹å®šäº‹ä»¶
                player.on('flash-ready', function() {
                    console.log(`RTMP Flashæ’­æ”¾å™¨å°±ç»ª ${streamId}`);
                });
            }
            
            // é€šç”¨ç½‘ç»œçŠ¶æ€ç›‘å¬
            player.on('progress', function() {
                const buffered = player.buffered();
                if (buffered.length > 0) {
                    const bufferedEnd = buffered.end(buffered.length - 1);
                    const currentTime = player.currentTime();
                    const bufferHealth = bufferedEnd - currentTime;
                    
                    if (bufferHealth < 1 && streamType === 'flv') {
                        updateStatus(streamId, 'ç¼“å†²ä¸è¶³');
                    }
                }
            });
        }
        window.addEventListener('beforeunload', function() {
            Object.values(players).forEach(player => {
                if (player && typeof player.dispose === 'function') {
                    player.dispose();
                }
            });
        });
    </script>
</body>
</html>